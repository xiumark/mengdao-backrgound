var chooseServer,__extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),Main=function(e){function t(){var t=e.call(this)||this;return t.stage?t.loadConfig():t.once(egret.Event.ADDED_TO_STAGE,t.loadConfig,t),t}return __extends(t,e),t.prototype.loadConfig=function(t){var e=this;void 0===t&&(t=null);var n=function(){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,n,e),e.loadGroup()};RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,n,this),RES.loadConfig("resource.json","resource/")},t.prototype.loadGroup=function(){var t=this,e=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,e,t),t.initUI()};RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e,this),RES.loadGroup("chooseServer")},t.prototype.initUI=function(){chooseServer.chooseServerBinder.bindAll(),fairygui.UIPackage.addPackage("chooseServer",RES.getRes("chooseServer_fui"));var t=chooseServer.UI_choose_server.createInstance();this._ui=t,this.addChild(fairygui.GRoot.inst.displayObject),fairygui.GRoot.inst.addChild(this._ui),t.state.setSelectedIndex(2),t.announce_info.list.callbackThisObj=this,t.announce_info.list.itemRenderer=this.renderAnnounceCell,this.onGotAnnounce(localStorage.getItem("SgServerAnnounce")),this.onResize()},t.prototype.renderAnnounceCell=function(t,s){var e=this.announceList[t],n=e.type,i=e.content;switch(n){case 0:s.type.setSelectedIndex(0),s.txt_title.text=i,s.height=71;break;case 1:s.type.setSelectedIndex(1),s.txt_content.text=i,s.txt_content.renderNow(),s.height=s.txt_content.displayObject.textHeight+20;break;case 2:s.type.setSelectedIndex(2),RES.getResAsync("announce_"+i+"_jpg",function(t,e){s.loader_info.__getResCompleted(t,e);var n,i=t.textureWidth,o=t.textureHeight,r=1;r=i<=512?1:512/i,s.loader_info.scaleX=s.loader_info.scaleY=r,n=s.loader_info.y+r*o+12,s.height=n},s)}},t.prototype.onGotAnnounce=function(t){if(t&&t.length){var e,n=t.split(/\r\n|\r|\n/);this.announceList=[];for(var i=0;i<n.length;i++){var o=n[i];0==i?this.announceList.push({type:0,content:o}):0<=o.indexOf("<img>")?(this.announceList.push({type:2,content:o.replace("<img>","")}),e=null):(e||(e={type:1,content:""},this.announceList.push(e)),e.content+=o+"<br>")}window.gameLink&&window.gameLink.length&&this.announceList.push({type:1,content:window.gameLink}),this._ui.announce_info.list.numItems=this.announceList.length}else alert("数据错误")},t.prototype.onResize=function(){var t=this._ui.sourceWidth,e=this._ui.sourceHeight,n=t,i=e,o=this.stage.stageWidth,r=this.stage.stageHeight;if(o<n||r<i){n=o/t,i=r/e;var s=Math.min(n,i);this._ui.scaleX=this._ui.scaleY=s}this._ui.x=o/2-t*this._ui.scaleX/2,this._ui.y=r/2-e*this._ui.scaleY/2},t}(egret.DisplayObjectContainer);!function(e){var t=function(){function t(){}return t.bindAll=function(){fairygui.UIObjectFactory.setPackageItemExtension(e.UI_announce_cell.URL,e.UI_announce_cell),fairygui.UIObjectFactory.setPackageItemExtension(e.UI_announce_loader.URL,e.UI_announce_loader),fairygui.UIObjectFactory.setPackageItemExtension(e.UI_choose_server.URL,e.UI_choose_server),fairygui.UIObjectFactory.setPackageItemExtension(e.UI_server_cell.URL,e.UI_server_cell),fairygui.UIObjectFactory.setPackageItemExtension(e.UI_server_tab.URL,e.UI_server_tab)},t}();e.chooseServerBinder=t}(chooseServer||(chooseServer={})),function(t){var e=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.createInstance=function(){return fairygui.UIPackage.createObject("chooseServer","announce_cell")},t.prototype.constructFromXML=function(t){e.prototype.constructFromXML.call(this,t),this.type=this.getController("type"),this.txt_title=this.getChild("txt_title"),this.txt_content=this.getChild("txt_content"),this.loader_info=this.getChild("loader_info")},t.URL="ui://kw5gcnwipa90g",t}(fairygui.GComponent);t.UI_announce_cell=e}(chooseServer||(chooseServer={})),function(t){var e=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.createInstance=function(){return fairygui.UIPackage.createObject("chooseServer","announce_loader")},t.prototype.constructFromXML=function(t){e.prototype.constructFromXML.call(this,t),this.list=this.getChild("list")},t.URL="ui://kw5gcnwipa90h",t}(fairygui.GComponent);t.UI_announce_loader=e}(chooseServer||(chooseServer={})),function(t){var e=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.createInstance=function(){return fairygui.UIPackage.createObject("chooseServer","choose_server")},t.prototype.constructFromXML=function(t){e.prototype.constructFromXML.call(this,t),this.type=this.getController("type"),this.state=this.getController("state"),this.txt_server_name=this.getChild("txt_server_name"),this.txt_state=this.getChild("txt_state"),this.btn_choose_server=this.getChild("btn_choose_server"),this.btn_startgame=this.getChild("btn_startgame"),this.btn_announce=this.getChild("btn_announce"),this.main_part=this.getChild("main_part"),this.btn_back=this.getChild("btn_back"),this.last_login=this.getChild("last_login"),this.list_tab=this.getChild("list_tab"),this.list_server=this.getChild("list_server"),this.list_part=this.getChild("list_part"),this.btn_back2=this.getChild("btn_back2"),this.announce_bg=this.getChild("announce_bg"),this.announce_info=this.getChild("announce_info"),this.announce_part=this.getChild("announce_part")},t.URL="ui://kw5gcnwipa90p",t}(fairygui.GComponent);t.UI_choose_server=e}(chooseServer||(chooseServer={})),function(t){var e=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.createInstance=function(){return fairygui.UIPackage.createObject("chooseServer","server_cell")},t.prototype.constructFromXML=function(t){e.prototype.constructFromXML.call(this,t),this.type=this.getController("type"),this.txt_server_name=this.getChild("txt_server_name"),this.txt_state=this.getChild("txt_state")},t.URL="ui://kw5gcnwipa90q",t}(fairygui.GComponent);t.UI_server_cell=e}(chooseServer||(chooseServer={})),function(t){var e=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.createInstance=function(){return fairygui.UIPackage.createObject("chooseServer","server_tab")},t.prototype.constructFromXML=function(t){e.prototype.constructFromXML.call(this,t),this.txt_name=this.getChild("txt_name")},t.URL="ui://kw5gcnwipa90r",t}(fairygui.GButton);t.UI_server_tab=e}(chooseServer||(chooseServer={}));